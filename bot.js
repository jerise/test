const Discord = require('discord.js');
const { Client, Util } = require('discord.js');
const client = new Discord.Client();
const prefix = '#'
const { PREFIX, GOOGLE_API_KEY } = require('./config');
const YouTube = require('simple-youtube-api');
const ytdl = require('ytdl-core');
const youtube = new YouTube(GOOGLE_API_KEY);
const queue = new Map();
const moment = require('moment');
const fs = require("fs");
const coolDown = new Set();
const Canvas = require('canvas');
const db = require('quick.db')
const ms = require('ms')
const bot = new Discord.Client();



client.on('ready', () => {
  console.log(`Logged in as ${client.user.tag}!`);
  console.log('')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•—')
  console.log(`[Start] ${new Date()}`);
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•—');
  console.log(`Logged in as * [ " ${client.user.username} " ]`);
  console.log('')
  console.log('Informations :')
  console.log('')
  console.log(`servers! [ " ${client.guilds.size} " ]`);
  console.log(`Users! [ " ${client.users.size} " ]`);
  console.log(`channels! [ " ${client.channels.size} " ]`);
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('â•”[â•â•â•â•â•â•â•â•â•â•â•â•]â•—')
  console.log(' Bot Is Online')
  console.log('â•š[â•â•â•â•â•â•â•â•â•â•â•â•]â•')
  console.log('')
  console.log('')
});


const seender = 'Ù„Ø¹Ù…Ù„ Ù…Ù†Ø´Ù† Ù„Ù…Ø±Ø³Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ù‡ Ù‚Ù… Ø¨ÙƒØªØ§Ø¨Ø© [Ø§Ù„Ù…Ø±Ø³Ù„] ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.';
const server = 'Ù„ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ø³ÙŠØ±ÙØ± Ù‚Ù… Ø¨ÙƒØªØ§Ø¨Ø© [Ø§Ù„Ø³ÙŠØ±ÙØ±] ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.';
const user = 'Ù„Ø¹Ù…Ù„ Ù…Ù†Ø´Ù† Ù„Ù„Ø´Ø®Øµ Ù‚Ù… Ø¨ÙƒØªØ§Ø¨Ø© [Ø§Ù„Ø¹Ø¶Ùˆ] ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.';
 
client.on('message', message => {
   if(!message.channel.guild) return;
    var success = new Discord.RichEmbed()
    .setDescription(`ØªÙ… Ø£Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­.`)
    .setColor('GREEN')
if(message.content.startsWith(prefix + 'bc')) {
if(!message.channel.guild) return message.channel.send('**Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙÙ‚Ø· Ù„Ù„Ø³ÙŠØ±ÙØ±Ø§Øª**').then(m => m.delete(5000));
if(!message.member.hasPermission('ADMINISTRATOR')) return      message.channel.send('**Ù„Ù„Ø£Ø³Ù Ù„Ø§ ØªÙ…ØªÙ„Ùƒ ØµÙ„Ø§Ø­ÙŠØ©** `ADMINISTRATOR`' );
let args = message.content.split(" ").join(" ").slice(2 + prefix.length);
let BcList = new Discord.RichEmbed()
.setColor('RANDOM')
.setDescription(`**â–¶ ğŸ“ Ù„Ø£Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù…Ø¨Ø¯ Ù‚Ù… Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ \n â–¶ âœ Ù„Ø£Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ø§Ø¯ÙŠØ© Ù‚Ù… Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ \n â˜… ${user} \n â˜… ${server} \n â˜… ${seender}**`)
if (!args) return message.reply('**ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ùˆ Ø¬Ù…Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙˆØ¯ÙƒØ§Ø³Øª**');message.channel.send(BcList).then(msg => {
msg.react('ğŸ“')
.then(() => msg.react('âœ'))
.then(() =>msg.react('ğŸ“'))
 
let EmbedBcFilter = (reaction, user) => reaction.emoji.name === 'ğŸ“' && user.id === message.author.id;
let NormalBcFilter = (reaction, user) => reaction.emoji.name === 'âœ' && user.id === message.author.id;
 
let EmbedBc = msg.createReactionCollector(EmbedBcFilter, { time: 60000 });
let NormalBc = msg.createReactionCollector(NormalBcFilter, { time: 60000 });
 
 
EmbedBc.on("collect", r => {
 
message.channel.send(success);
message.guild.members.forEach(m => {
let EmbedRep = args.replace('[Ø§Ù„Ø³ÙŠØ±ÙØ±]' ,message.guild.name).replace('[Ø§Ù„Ø¹Ø¶Ùˆ]', m).replace('[Ø§Ù„Ù…Ø±Ø³Ù„]', `${message.author}`)
var bc = new
Discord.RichEmbed()
.setColor('RANDOM')
.setDescription(EmbedRep)
.setFooter(`${prefix}invite | Ù„Ø¯Ø¹ÙˆØ© Ø¨Ø±ÙˆØ¯ÙƒØ§Ø³Øª Ø¨ÙˆØª`)
m.send({ embed: bc })
msg.delete();
})
})
NormalBc.on("collect", r => {
  message.channel.send(success);
message.guild.members.forEach(m => {
let NormalRep = args.replace('[Ø§Ù„Ø³ÙŠØ±ÙØ±]' ,message.guild.name).replace('[Ø§Ù„Ø¹Ø¶Ùˆ]', m).replace('[Ø§Ù„Ù…Ø±Ø³Ù„]', `${message.author}`)
m.send(NormalRep);
msg.delete();
})
})
})
}
});

client.on("message",async message => {
if(message.content === 'shop'){//Ø§Ù„Ø§Ù…Ø±
let staff = message.guild.member(message.author).roles.find('name' ,"shop");
      if(!staff) return message.reply(`**Only Sellers | :x:**`)
var shopc = message.guild.channels.find("name","shop")
  if(!shopc) return message.reply("Ù„Ø§ Ø§Ø¬Ø¯ Ø§Ù„Ø±ÙˆÙ… Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø¨ÙŠØ¹")
    let shop = '';
      let fillter = m => m.author.id === message.author.id
      
     

      await message.channel.send("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø´ÙŠØ§Ø¡ Ø§Ù„Ø°ÙŠ Ø³ÙˆÙ ØªØ¨ÙŠØ¹Ù‡Ø§").then(e => {
           message.channel.awaitMessages(fillter, { time: 60000, max: 1                                    
})
     .then(co => {
       shop = co.first().content;
        co.first().delete();
     
let desc = '';
        
e.edit("Ø§ÙƒØªØ¨ Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ù…ÙŠÙ†ØŸ").then(e => {
  message.channel.awaitMessages(fillter, { time: 60000, max: 1 })

     .then(co => {
       desc = co.first().content;
        co.first().delete();
e.edit("Done").then(e => {
  shopc.send(`@everyone <$> @here
${message.guild.name}:tm: Shop :arrow_down:
======================
${shop}
=================
**Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯:** **${desc}**

**ØªÙ… Ø§Ù„Ø§Ø±Ø³Ø§Ù„ Ø¨ÙˆØ§Ø³Ø·Ø©:** ${message.author}
@everyone </> @here`)
  })
})
  })
})
  })
           
      
  
     
  
      
           
}
});

giftKeys = {};
let devs = ["448444251504640012",""]; // ØªÙ‚Ø¯Ø± ØªØ¶ÙŠÙ Ø§ÙŠØ¯ÙŠ Ø«Ø§Ù„Ø« Ù†ÙØ³ Ø§Ù„ÙÙƒØ±Ù‡ ØªØ³ÙˆÙŠ ÙƒØ°Ø§ let devs = ["Ø§ÙŠØ¯ÙŠÙƒ","Ø§ÙŠØ¯ÙŠ Ø®ÙˆÙŠÙƒ Ø§Ùˆ Ø¥ÙŠ Ø§Ø¯Ù…Ù†","Ø§ÙŠØ¯ÙŠ Ø®ÙˆÙŠÙƒ Ø§Ù„Ø«Ø§Ù„Ø«"];
client.on("message", msg =>{
  let args = msg.content.split(" ").slice(1)[0];
  let cmd = msg.content.split(' ')[0]
  if(cmd === `${prefix}giftR`){
  let roleW = msg.mentions.roles.first();
  if(!devs.includes(msg.author.id)){
    let embed = new Discord.RichEmbed()
    .setColor("#42f4f4")
    .setTitle(`:x: - Ø§Ù†Øª Ù„Ø§ØªÙ…ØªÙ„Ùƒ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©`);
    msg.reply(embed).then( z => z.delete(3000));
     return
  }
  if(!roleW) {
    let embed = new Discord.RichEmbed()
    .setColor("#42f4f4")
    .setTitle(`:x: - Ù…Ù†Ø´Ù† Ø§Ù„Ø±ØªØ¨Ø© \`${prefix}giftR <@admin-role>\``);
    msg.reply(embed).then( z => z.delete(3000)); return
  };
  let role = msg.guild.roles.find(`name`, roleW.name);
  if(!role) {
    let embed = new Discord.RichEmbed()
    .setColor("#42f4f4")
    .setTitle(`:x: - Could't find \`${roleW.name}\` role.`);
  msg.reply(embed).then( msgs => msgs.delete(3000));
  return
  }
  var randomkeys = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  var gift = "";
  for (var y = 0; y < 16; y++) {   ///16
    gift +=  `${randomkeys.charAt(Math.floor(Math.random() * randomkeys.length))}`;
  }
  giftKeys[gift] = role;
  let embed = new Discord.RichEmbed()
  .setColor("#42f4f4")
  .setTitle(`:ok_hand: - **ØªÙ… Ø§Ø±Ø³Ø¢Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Øµ**`);
  msg.reply(embed);
  let embed2= new Discord.RichEmbed()
  .setAuthor(msg.author.username, msg.author.displayAvatarURL)
  .setThumbnail(msg.author.avatarURL)
  .addField("**Key Of Gift**", gift,true)
  .addField("Role",giftKeys[gift].name,true)
  .addField("This Key Made by", msg.author, true)
  .addField("The Room", msg.channel , true)
  .setTimestamp()
  .setFooter(client.user.username,client.user.displayAvatarURL)  
  msg.author.send(embed2);
};
if( cmd === `${prefix}used`){
 
  if(!args) {  
    let embed = new Discord.RichEmbed()
    .setColor("#42f4f4")
    .setTitle(`:x: - **Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ù‡Ø¯ÙŠØ©** \`${prefix}used <Key>\``)
    msg.reply(embed).then( z => z.delete(3000));
    return
}
let embed = new Discord.RichEmbed()
.setTitle(`**Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯**`)
.setColor("#42f4f4")
  msg.reply(embed).then( msgs =>{
  if(giftKeys[args]){
    let hav = msg.member.roles.find(`name`, giftKeys[args].name);
    if(hav){
    let embed = new Discord.RichEmbed()
    .setTitle(`:x: - **Ø§Ù†Øª ØªÙ…ØªÙ„Ùƒ Ù‡Ø°Ù‡ Ø§Ù„Ø±ØªØ¨Ø© Ù…Ø³Ø¨Ù‚Ù‹Ø§**  \`${giftKeys[args].name}\``)
    .setColor("#42f4f4")
    msgs.edit(embed)
    return
    }
    let embed = new Discord.RichEmbed()
    .setTitle(`:tada: - **Ù…Ø¨Ø±ÙˆÙƒ ØªÙ… Ø§Ø¹Ø·Ø§Ø¦Ùƒ Ø±ØªØ¨Ø©** \`${giftKeys[args].name}\``)
    .setColor("#42f4f4")
    msgs.edit(embed)
    msg.member.addRole(giftKeys[args]);
    delete giftKeys[args]
  }else{
    let embed = new Discord.RichEmbed()
    .setTitle(`:x: - **Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµÙŠØ­ÙŠØ­ Ø£Ùˆ Ø§Ù†Ù‡ Ù…Ø³ØªØ¹Ù…Ù„ Ù…Ù† Ù‚Ø¨Ù„**`)
    .setColor("#42f4f4")
    msgs.edit(embed)
  }});
};
});

client.login(process.env.BOT_TOKEN);
